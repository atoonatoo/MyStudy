

----
##### 연결 문서

- [[6 - ATNT/2 Area/Operation System]]
- [[RAM]]
- [[보조 기억 장치]]
---

### 제목 : Swap

 - Swap이란? 

	RAM의 용량 즉 시스템의 메모리가 부족할 경우 데이터 손실이 일어나거나 프로세스가 가동할 수 없는, 프로세스의 동작이 문제가 생길 경우를 사전에 방지하고자 보조 기억 장치인 HDD나 SDD 공간을 활용하여 메모리 역할을 할 수 있게 도와주는 영역을 의미한다.

- Swap의 동작 원리 - Swapping 
  
	  실제 메모리(RAM) 가득차면 Swap 공간이 사용되는데, 물리 메모리의 비활성 페이지가 
	  Swap 공간으로 이동하게 되면서 사용하게 된다. 
	  만약 물리 메모리 공간이 여유가 되서 동작을 위한 용량이 확보되면 다시 Swap 공간에서
	  물리 메모리 공간으로 영역으로 페이지가 할당된다. 

	![[Swap의 Swapping 과정 2.png]]

- 만약 사용 중인 프로세스의 의해서 물리 메모리 공간이나 Swap 공간이 둘 다 Full이 되면? 

	SystemHong 상태에 빠지게 되며, 메모리 확보를 할 수 있도록 어떤 프로세스가 종료되거나 
	예정 되어있었던 작업이 마치게 되면 해소 될 수도 있지만 대부분 어떠한 작업도 할 수 없는 
	Freeze 상태가 된다.

	이런 경우는 재부팅을 시키거나, Kdump(Kernel의 Memory단 Dump)를 떨어뜨리고 재기동 시켜주는 trigger를 동작 시켜 해당 Dump를 분석하여 원인을 파악해야 한다. 
	(사전에 Kdump 활성화 필수)

	떨어뜨린 Dump의 내용은 메모리의 저장된 정보를 떨어뜨리기 때문에 메모리를 분석하는 
	특정 Tool을 사용해 분석해야 하고 전문적인 지식이 필요하기 때문에 벤더사에 의뢰하는 것이 
	올바르다. (ex Rad Hat을 통한 CaseOpen)

- Swap의 종류 

	Filesystem 형태로도 생성할 수 있고 Partition Volume 형태로도 사용할 수 있다.
	(Filesystem 형태 : 이미 생성된 공간에 특정 사이즈를 가진 파일 형태로 존재)

	대부분 Linux 배포판에선 해당 Swap 공간을 Filesystem 형태보단 Partition Volume 형태로
	사용하는 것을 권고한다. 
	(PS : Swap을 따로 할당하지 않아도 물리 메모리만 충분하다 운영하는데 문제가 없다.)

- Swap의 용량
  
	운영 환경 시스템의 활용, 구성에 따라 권장 사양이 각각 다를 수 있다.
	(ex. 어플리케이션단에서 사용되는 솔루션 공급업체에서 공급하는 Swap의 사이즈가 존재할 수 있다. )

	배포판마다 다르지만 예전에는 서버를 운용할 때 장착 되어있는 물리 메모리의 사양이 높지
	않아서 Red Hot에선 물리 메모리의 20%정도 되는 사이즈를 권고하였다.
	요즘은 고사양의 운용 장비들이 많기에 swap을 설정하지 않아도 된다는 견해도 있지만
	그럼에도 설정하겠다면 물리 메모리 64GB 이하에서 Swap 사이즈를 4GB정도 가지는 것을 
	권장하고 있고 2~8GB 사이의 물리 메모리가 장착되어 있다면 RAM 용량과 동일하게
	생성하는 것을 권장한다.

- Swap의 생성 방법

	 (당장은 중요한 부분이 아니라 추후 작성한다.) 

- Swap의 특징 및 주의 사항

	Swap 메모리 영역은 시스템의 메인 메모리가 부족한 상황에서 성능보다는 메모리 부족으로 
	인한 프로세스의 갑작스런 Cash 상황이나 Hang 상태를 방지로 만든 임시/보조의 공간이다. 
	또한 저장 공간의 영역인 HDD, SDD에 존재하는 실제 물리 메모리보다 10배 이상 차이가 난다. 
	당연히 Swapping 없이 물리 메모리 선에서 프로세스가 하고자 하는 일을 마무리 짓는 것이 
	좋으니 메모리 부족 현상이 일어나면 Swap 공간의 확장보다는 물리 메모리 증설이 권고 된다.



