### 기능 구현

- **1. 의존방향을 도메인 방향으로만 흐르도록하여 외부 요소의 변경에 취약하지 않도록 설계**
	- **코드 복잡성을 높이지 않기 위해 인터페이스를 과도하게 사용하지 않도록 함***
	- 내 프로젝트에 적용이 가능할 것 같다.
	- (계획 작성)
---
 - **2. AWS SQS를 이용하여 푸시 서버와의 연동을 비동기 방식으로 구현**
	- **시스템 간의 의존도를 낮추고, 트래픽 급증 시에도 안정적인 푸시 알림 전달하기 위함**
	- 내 프로젝트에 적용하기 위해선 알람 기능을 추가해야한다.
	- 알림이 아니어도 시간이 오래 걸리거나 실패/재시도 가능성이 있는 작업은 전부 큐로 빼는 게 좋을 것 같다.
	- 당장은 기능 추가보다 적용할 수 있는 기능을 구상해보자.
	
	- **2.1 아이디어**
		- 내 플레이리스트 동영상 썸네일 생성? / 영상 인코딩?
			- 사용자가 영상을 업로드하면, 그 즉시 처리하지 않고 백그라운드에서 썸네일 생성 혹은 인코딩을 수행
			- 영상 파일 업로드만 빠르게 끝내고,  실제 썸네일 생성은 메시지 큐(SQS, 메모리 큐 등)에 넘겨서 처리
			-  업로드 시 UX 빠름, - 트래픽 많아도 서버가 감당 가능, 처리 실패 시 재시도도 가능
		
		- 사용자 활동 기록 저장 (Audit 로그)
			- 사용자의 로그인, 재생목록 추가, 영상 재생, 좋아요 클릭 등을 메시지 형태로 큐에 쌓고, 별도 DB 혹은 로그 서버에 기록
			- 서비스 흐름에 방해 없이 로그 수집 가능
			- 추후 통계, 분석, 추천 로직에 활용 가능
		  
		- 이메일 인증 / 회원가입 후 환영 메일 발송
			- 회원가입 완료 시, 이메일 발송 요청을 바로 처리하지 않고 큐에 넣음
			- 별도 worker에서 메일 서버와 연결해 발송
			- 메일 서버 응답 지연으로 인해 회원가입 UX가 느려지는 걸 방지
			- 메일 서버 장애 시에도 재시도 로직 가능
		  
	- **2.2. SQS 대처 방법**
		1. 스프링에서 @Async + 스레드풀 사용
		2. 메모리 기반 BlockingQueue 사용해서 간이 큐 만들기
		3. DB 기반 큐 구현 (장기적 작업용)
  ---
- **3. Spring Security를 사용해 익명 사용자 및 인증된 사용자의 다양한 활동에 대한 접근 제어 리스트(ACL)를 구현하고, 행위별 보안 정책을 적용**
	- 유저 정보 
		- 내정보 조회 - 로그인한 사용자만
		- 유저 강제 정지 - ADMIN 권한만
	- 재생목록
		- 생성 - 로그인한 사용자만
		- 조회 - 공개일 경우 누구나, 비공개일 경우 소유자만
		- 수정/삭제 - 생성자(소유자)만 할 수 있다.
---
- **4. 단위, 통합 테스트 케이스 300여개 작성**
- 
---

#### 개선 사항 
- 댓글 조회 중 Order By가 선적용 되는 슬로우 쿼리 발견 및 개선 
	- 생성순 정렬을 위해 Order By절에 PK를 사용하고, 조건절에 사용되는 외래키가 인덱스를 사용하지 않아 선 정렬 후 필터링 하여 21초가 걸리던 문제를 실행계획 분석하여 인덱스 사용할 수 있도록 유도하여 0.15초로 정상화 
	- 옵티마이저의 잘못된 판단을 알려주기 위해서 인덱스 힌트 유도, FROM절 서브쿼리 사용, 쿼리문 개조, 복합 컬럼 인덱스 등을 통한 다양한 해결방법 고민 
	- 인덱스 힌트 유도 및 FROM절 서브쿼리는 플러그인이 필요하고, 조건문 변경에 대해 취약하기 때문에 시간순 정 렬이 요구사항임에 따라 생성시간 컬럼과 외래키를 묶어 복합 컬럼 인덱스를 사용하여 해결 
- LocalStack-SQS 기반 테스트 환경 도입 및 확산 
	- LocalStack-SQS를 활용한 테스트를 통해 테스트 권한 및 비용 문제에 대해 해결. 
	- 해당 테스트 설정과 경험을 팀원들과 공유