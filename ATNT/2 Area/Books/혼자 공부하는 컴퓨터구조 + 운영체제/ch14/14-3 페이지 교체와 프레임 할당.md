생성일 | {{2024-01-28}}
작성자 | 김동욱


# 14-3 페이지 교체와 프레임 할당
### 요약
- 요구 페이징은 페이지가 필요할 때에만 메모리에 적재하는 기법이다.
- 페이지 교체 알고리즘에는 FIFO, 최적, LRU 페이지 교체 알고리즘 등이 있다.
- 스래싱이란 지나치게 빈번한 페이지 교체로 인해 CPU 이용률이 낮아지는 문제를 뜻한다.
- 프레임 할당 방식에는 균등 할당과 비례 할당, 작업 집합 모델 기반과 페이지 폴트율 기반 프레임 할당 방식이 있다.
---
- 메모리 할당에 대한 문제점
	- 물리 메모리보다 큰 프로세스를 실행할 수 있지만, 그럼에도 물리 메모리의 크기는 명확하게 한정되어 있다.
	1. 기존에 적재된 불필요한 페이지를 선별해 보조기억장치로 내보내야한다.
		- 해결방안 - 페이지 교체
	2. 프로세스들에게 적절한 수의 프레임을 할당해야한다.
		- 해결방안 - 프레임 할당 
		
		
		
- 요구 페이징
	- 처음부터 모든 페이지를 적재하지 않고 필요한 페이지만 메모리에 적재하는 기법
	- 요구되는 페이지만 적제하는 기법
		1. CPU가 특정 페이지에 접근하는 명령어를 실행
		2. 해당 페이지가 현재 메모리에 있을 경우 (유효 비트가 1일 경우) CPU는 페이지가 적재된 프레임에 접근
		3. 해당 페이지가 현재 메모리에 없을 경우 (유효 비트가 0일 경우) 페이지 폴트가 발생
		4. 페이지 폴트 처리 루틴은 해당 페이지를 메모리로 적재하고 유효 비트를 1로 설정
		5. 다시 1번을 수행
	- 요구 페이징이 안정적으로 작동하려면 해결해야 할 문제
		- 페이지 교체 알고리즘 / 프레임 할당
	
	
	
- 페이지 교체 알고리즘
	- 요구 페이징기법으로 페이지들을 적재하다보면 언젠가 메모리가 가득 참
	- 당장 실행에 필요한 페이지를 적재하려면 적재된 페이지를 보조기억장치로 내보내한다.
	- 이때 어떤 페이지를 내보낼지 결정하는 방법
	  
	- 좋은 페이지 교체 알고리즘
		- 페이지 폴트가 적은 알고리즘
			- 페이지 폴트가 발생하면 보조기억장치에 접근헤야해서 성능 저하
		
	- 페이지 참조열
		- CPU가 참조하는 페이지들 중 연속된 페이지를 생랴간 페이지열
		- 페이지 참조열 전 : 2 2 2 3 5 5 5 3 3 7
		- 페이지 참조열 후 : 2 3 5 3 7
		  
		  
		
	- FIFO 페이지 교체 알고리즘![[스크린샷 2024-02-03 060152.png]]
		- 가장 단순한 방식
		- 메모리에 가장 먼저 올라온 페이지부터 내쫒는 방식
		- 적합 : 프로그램 싱행 초기에 잠깐 실행될 페이지
		- 부적합 : 프로그램 실행 내내 사용될 페이지
		
		
		
	- FIFO 페이지 교체 알고리즘 - 보완책![[스크린샷 2024-02-03 060637.png]]
		- 2차 기회 페이지 교체 알고리즘
		- 참조 비트 1 : CPU가 한 번 참조한 적이 있는 페이지
			- 한번 더 기회를 주기
			- 참조 비트 0으로 초기화 후 적재 시간을 가장 최근 시간으로 설정
		- 참조 비트 0 : CPU가 참조한 적이 없는 페이지
			- 내쫒기 
		
		
		
	- 최적 페이지 교체 알고리즘![[스크린샷 2024-02-03 060940.png]]
		- 앞으로의 사용 빈도가 가장 낮은 페이지를 교체하는 알고리즘
			- CPU에 의해 참조되는 횟수를 고려
			- 메모리에 오래 남아야 할 페이지는 자주 사용될 페이지
			- 메모리에 없어도 될 페이지는 오랫동안 사용되지 않을 페이지
			- 가장 낮은 페이지 폴트율을 보장하는 알고리즘
			- 그러나 실제 구현이 어렵다.
				- 앞으로 오랫동안 사용되지 않을 페이지를 어떻게 예측하는가
				- 다른 페이지 교체 알고리즘 성능을 평가하기 위한 하한선으로 간주
		
		
	- LRU 페이지 교체 알고리즘![[스크린샷 2024-02-03 061419.png]]
		- 가장 오래 사용되지 않은 페이지 교체
	
	
	
	- 페이지 교체 알고리즘을 배워야하는 이유
		- 모든 알고리즘을 이해하기보단 페이지 교체 알고리즘이 무엇인지
		- 페이지 교체는 왜 해야 하는지
		- 무엇이 좋은 페이지 교체 알고리즘인지를
		- 유의하여 배울 것
	  
	  
	  
	- 스레인과 프레임 할당![[스크린샷 2024-02-03 061714.png]]
		- 페이지 폴트가 자주 발생하는 이유
			- 나쁜 페이지 교체 알고리즘을 사용해서
			- 프로세스가 사용할 수 있는 프레임 자체가 적어
			  
			  
			  
	- 스레싱![[스크린샷 2024-02-03 061824.png]]
		- 프로세스가 실행되는 시간 보다 페이징에 더 많은 시간을 소요하여 성능(CPU이용률)이 저해되는 문제
		  
		  
	- ![[스크린샷 2024-02-03 061834.png]]
		- 동시에 실행되는 프로세스의 수를 늘린다고 CPU 이용률이 높아지는 것이 아님
		  
		  
	- 스레싱이 발생하는 이유
		- 각 프로세스가 필요로 하는 최소한의 프레임 수가 보장되지 않았기 때문
		- 각 프로세스가 필요로 하는 최소한의 프레임 수를 파악하고 프로세스들에게 적절한 프레임을 할당해주어야 한다.
	  
	  
	- 프레임 할당 방식
		- 균등 할당
			- 가장 단순한 할당 방식
			- 모든 프로세스들에게 균등하게 프레임을 할당하는 방식
		- 비례 할당
			- 프로세스의 크기를 고려한다.
			- 프로세스 크기에 비례하여 프레임 할당
			- 한계
				- 크기가 큰 프로세스를 막상 실행해보니 많은 프레임을 필요X
				- 크기가 작은 프로세스를 막상 실행해보니 많은 프레임을 필요
				- 결국 프로세스가 필요로 하는 프레임 수는 실행해봐야 안다.
		
		
	- 작업 집합 모델
		- 프로세스 실행하는 괴정에서 배분할 프레임 결정
		- 스레싱이 발생하는 이유는 빈번한 페이지 교체 때문
			- CPU가 특정 시간 동안 주로 참조한 페이지 개수만큼만 프레임을 할당
		- 프로세스가 일정 기간 동안 참조한 페이지 집합을 기억하여 빈번한 페이지 교체를 방지
			- 작업 집합이란 실행 중인 프로세스가 일정 시간 동안 참조한 페이지의 집합
		
		
	- 작업 집합 모델![[스크린샷 2024-02-03 062954.png]]
		- 작업 집합을 구하기 위해
			1. 프로세스가 참조한 페이지
			2. 시간 간격이 필요
			   
			   
	- 페이지 폴트 빈도![[스크린샷 2024-02-03 063441.png]]
		- 프로세스가 실행하는 과정에서 배분할 프레임 결정
		- 페이지 폴트율에 상한선과 하한선을 정하고, 그 내부 범위 안에서만 프레임을 할당하는 방식
		- 프로세스가 실행하는 과정에서 배분할 프레임 결정
		- 두 개의 가정에서 생겨난 아이디어
			1. 페이지 폴트율이 너무 높으면 그 프로세스는 너무 적은 프레임을 갖고 있다
			2. 페이지 폴트율이 너무 낮으면 그 프로세스가 너무 많은 프레임을 갖고 있다.

---