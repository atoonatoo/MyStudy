생성일 | {{2024-01-09}}
작성자 | 김동욱
# 07-1 다양한 보조기억장치

### 요약

- 하드 디스크의 구성 요소에는 플래터, 스핀들, 헤드, 디스크 암이 있다.
- 플래터는 트랙과 섹터로 나뉘고, 여러 플래터의 동일한 트랙이 모여 실린더를 이룬다.
- 하드 디스크의 데이터 접근 시간은 크게 탐색 시간, 회전 지연, 전송 시간으로 나뉜다.
- 프 ㄹ래시 메모리는 한 셀에 몇 비트를 저장할 수 있느냐에 따라 SLC, MLC, TLC로 나뉜다.
- 플래시 메모리의 읽기와 쓰기는 페이지 단위로, 삭제는 블록 단위로 이루어진다.
  
----
## 하드 디스크

- 하드디스크란? 
	- 자기적인 방식의 보조기억장치
	- 대용량 저장 장치가 필요한 작업 / 서버실
	  
- 하드 디스크의 동작원리 
	- 하드 디스크의 동작원리는 음향 장치 LP와 유사하다. 
	- 동그란 원판에 데이터를 저장, 그것을 회전시켜 뾰족한 리더기로 데이터를 읽는다.
	
- 하드 디스크의 구조
	- 플래터 (Platter)
		- 실질적으로 데이터가 저장되는 곳
		- 동그란 원판
		- 자기적인 방식으로 데이터를 저장 
		- 자기 물질로 덮여 있는 수많은 N극과 S극을 저장
		- N극과 S극은 0과 1의 역할을 수행
	- 스핀들 (Spindle)
		- 플래터를 회전시키는 구성 요소
		- 스핀들이 플래터를 돌리는 속도는 분당 회전수를 나타내는 RPM이라는 단위로 표현
		- RPM : 15,000 = 1분에 15,000 바퀴를 회전하는 하드 디스크
	- 헤드 (Head)
		- 플래터를 대상으로 데이터를 읽고 쓰는 구성 요소
		- 플래터 위에 미세하게 떠있는채로 데이터를 읽고 쓰는 바늘 같은 부품
		- 헤드는 원하는 위치로 이동 시키는 디스크 암(Disk arm)에 부착되어 있음
	- 하드디스크는 많은 데이터를 저장하기 위해서
		일반적으로 여러 겹의 플래터로 이루어졌고 플래터의 양면을 모두 사용할 수 있다. 
	- 양면 플래터를 사용하면 위 아래로 플래터당 두 개의 헤드가 사용된다.
		이때 일반적으로 모든 헤드는 디스크 암에 부착되어 다같이 이동한다.
	
- 플래터에 데이터가 저장되는 원리
	- 플래터는 트랙(Track)과 섹터(sector)라는 단위로 데이터를 저장한다.
	- 트랙 
			- 플래터를 여러 동심원으로 나누었을 때 그 중 하나의 원을 트랙이라고 한다.
	- 섹터 
			- 트랙을 피자처럼 여러 조각을 나뉘는데 이 한 조각을 섹터라고 한다.
			- 섹터는 하드 디스크의 가장 작은 단위이다.
			- 일반적인 섹터의 크기는 512 byte ~ 4096 byte 정도 이다.
	-  실린더 
		- 여러 겹의 플래터 상에서 같은 트랙이 위치한 곳을 모아 연결한 논리적 단위를 실린더(Cylinder)라고 한다. 
		- 쉽게 말해 한 플래터를 동심원으로 나눈 공간을 트랙, 같은 트랙끼리 연결한 원통 모양의 공간은 실린더이다.
		- 연속된 정보는 보통 한 실린더에 기록된다. 
		- 예를 들어 두 개의 플래터를 사용하는 하드 디스크에서 네 개 섹태에  걸쳐 데이터를 저장할 때는 첫 번쨰 플래터 윗면, 뒷면과 두번째 플래터 윗면, 뒷면에 데이터를 저장한다. 
		- 연속된 정보를 하나의 실린더에 기록하는 이유는 디스크 암을 움직이지 않고도 바로 데이터에 접근할 수 있기 때문이다.
	  
- 하드 디스크의 저장된 데이터를 접근하는 과정
	- 하드 디스크가 저장된 데이터에 접근하는 시간
		- 크게 탐색 시간, 회전 지연, 전송 시간으로 나뉜다.
	- 탐색 시간(seek time) 
		- 접근할 데이터가 저장된 트랙까지 헤드를 이동시키는 시간
	- 회전 지연(rototional latency) 
		- 헤드가 있는 곳으로 플래터를 회전시키는 시간
	- 전송 시간(transfer time)
		- 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간
	
- 컴퓨터의 시간
	- ns(나노초)는 10의 9승 초이다. 그리고 패킷(packet)이란 네트워크의 기본적인 전송 단위
		2011년에 자료가 공개된 이후 오늘날 하드 디스크 성능은 많이 향상되었지만, 
		하드 디스크에서 다량의 데이터를 탐색하고 읽어 들이는 시간은 
		생각보다 어마어마하다는 사실을 쉽게 짐작할 수 있다. 
		탐색 시간과 회전 지연을 단축시키기 위해서는 
		플래터를 빨리 돌려 RPM을 높이는 것도 중요하지만, 
		06-3절에서 배운 참조 지역성,
		즉 접근하려는 데이터가 플래터 혹은 헤드를 조금만 옮겨도 접근할 수 있는 곳에 
		위치해 있는 것도 중요하다.

<제프 딘 : "프로그래머가 꼭 알아야 하는 컴퓨터 시간들">

| L1 캐시 참조 시간 | 0.5ns |
| ---- | ---- |
| L2 캐시 참조 시간 | 5ns |
| 메모리 참조 시간 | 7ns |
| 메모리에서 1MB를 순차적으로 읽는 시간 | 250,000ns |
| (하드) 디스크 탐색 시간 | 10,000,000ns |
| (하드) eltmzmdptj 1MB를 순차적으로 읽는 시간 | 30,000,000ns |
| 한 패킷이 캘리포니아에서 네덜란드까지 왕복하는 시간 | 150,000,000ns |
- 다중 헤드 디스크와 고정 헤드 디스크
	- 단일 헤드 디스크(single-head-disk)
		- 플래터의 한 면당 헤드가 하나씩 달려 있는 하드 디스크
	- 다중 헤드 디스크(multiple-head disk)
		- 헤드가 트랙별로 여러 개 달려 있는 하드 디스크  
		- 다중 헤드 디스크는 트랙마다 헤드가 있기 때문에 탐색 시간이 들지 않는다. 
		- 따라서 다중 헤드 디스크는 탐색 시간이 0이다.
	- 고정 헤드 디스크와 단일 헤드 디스크
		- 이런 점에서 헤드를 움직일 필요가 없는 다중 헤드 디스크를 고정 헤드 디스크(fixed-head disk)라고 부른다. 
		- 반대로 헤드를 데이터가 있는 곳까지 움직여야 하는 단일 헤드 디스크(movable-head disk)를 이동 헤드 디스크라고 부른다.
	
- 하드 디스크 작동 영상 추천
	- 'hard drive running'
		https://www.youtube.com/shorts/EWJnkEesic8
	- 'hard drive in slow motion' 
		https://www.youtube.com/watch?v=3owqvmMf6No
	
## 플래시 메모리

- 플래시 메모리란?
	- 전기적으로 데이터를 일고 쓸 수 있는 반도체 기반의 저장 장치
	- USB 메모리, USB 메모리, SD 카드, SSD 등 
	- 보조기억장치의 범주를 벗어나 다양한 곳에 널리 사용하는 저장 장치
	
- 플래시 메모리의 종류
	- NAND 플래시 메모리 
		- 대용량 저장 장치로 많이 사용되는 플래시 메모리는 ANAD의 플래시 메모리
		-  NAND 연산을 수행하는 회로를 기반으로 만들어진 메모리
		- 보조기억장치로서의 플래시 메모리
			본문의 특별한 언급이 없는 한 NAND의 플래시 메모리를 지칭한다.
	- NOR 플래시 메모리
		- NOR 연산을 수행하는 회로를 기반으로 만들어진 메모리
	- 셀(cell)
		- 셀이란 플레시 메모리에서 데이터를 저장하는 가장 작은 단위
		- 이 셀이 모이고 모여, MB, GB, TB 용량을 갖는 저장 장치가 되는 것
		- 이 때 하나의 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리 종류가 나뉜다.
		- SLC(Single Level Cell) 타입
			- 한 셀이 1비트를 저장할 수 있는 플래시 메모리
		- MLC(Multiple Level Cell) 타입
			- 한 셀에 2비트를 저장할 수 있는 플래시 메모리
		- TLC(Triple-Level Cell) 타입
			- 한 셀에 3비트를 저장할 수 있는 플래시 메모리 
		- 세가지 타입의 차이에 대하여
			- 큰 차이가 아닌 것처럼 보여도 이는 플래시 메모리의 수명, 속도, 가격에 큰 영향을 끼친다. 
			- 한 셀에 4비트를 저장할 수 있는 QLC 타입도 있지만 SLC, MLC, TLC 타입의 특징을 이해하면 QLC 타입의 특징도 충분히 짐작할 수 있기 때문에 생략한다.
	
- 플래시 메모리의 수명
	- 플래시 메모리에는 수명이 있다. 
	- 플래시 메모리뿐만 아니라 하드 디스크 또한 수명이 있다.
	- 우리가 사용하는 USB 메모리, SSD, SD 카드는 수명이 다하면 더 이상 저장 장치로써 사용이 불가능하다. 
	- 종이에 연필로 쓰고 지우개로 지우고를 반복하다보면 결국 종이가 찢어지는 것과 같다.
	- 한 셀에 일정 횟수 이상 데이터를 쓰고 지우면 그 셀은 더 이상 데이터를 저장할 수 없기 때문이다. 
	
- SCL, MLC, TLC 타입의 특징과 차이점
	- 사람은 한명을 비트, 셀을 집에 비유하면 
		  SLC 타입은 한 집에 한명, 
		  MLC 타입은 한 집에 두명, 
		  TLC 타입은 세 명이 사는 구조로 비유할 수 있다.
	- SLC 타입
		- 한 셀로 두 개의 정보를 표현할 수 있는 타입
		  - 0 | 1
		- 홀로 거주하는 집에 제약없이 출입이 가능하듯 SLC 타입은 다른 타입에 비해 
			비트의 빠른 입출력이 가능하다.
		- 수명도 다른 타입보다 길어서 수만 ~ 수십만 번 가까이 데이터를 쓰고 지우고를 반복할 수 있다. 
		- 하지만 SLC 타입은 용량 대비 가격이 높다. 
		- 이는 마치 혼자서 살면 감당해야 할 주거 비용이 커지는 것과 같다. 
		- 그렇기에 데이터를 읽고 쓰기가 매우 많이 반복되며 고성능의 빠른 저장 장치가 필요한 경우에 SLC 타입을 사용한다.
	- MLC 타입
		- 한 셀로 네 개의 정보를 표현할 수 있다.
			-  00 | 01 | 10 | 11
		- SLC 타입보다 일반적으로 속도와 수명은 떨어지진다.  
			하지만 한 셀에 두 비트씩 저장할 수 있다는 점에서 
			SLC 타입보다 대용화하기 유리하다. 
		- 집의 개수가 같다면 한 집에 한 명씩 사는 것보다 
			한 집에 두 명씩 사는 것이 훨씬 더 많은 사람을 수용할 수 있는 것과 같은 이치이다.
		- 두명이 한 집에서 주거 비용을 나눠 내면 혼자 감당해야 하는 주거 비용보다 저렴해지듯 MLC 타입은 SLC 타입보다 용량 대비 가격이 저렴하다. 
		- 시중에서 사용되는 많은 플래시 메모리 저장 장치들이 MLC 타입(혹은 후술할 TLC 타입)으로 만들어진다.
	- TLC 타입
		- 한 셀로 여덟 개의 정보를 표현할 수 있다. 
			- 000 | 001 | 010 | 100 | 110 | 101 | 011 | 111
		-  대용화 하기가 유리하다. 
		- 일반적으로 다른 타입보다 수명과 속도가 떨어지지만 용량 대비 가격도 저렴하다.
	- 정리 
		- 같은 용량의 플래시 메모리 저장 장치라고 할지라도 셀의 타입에 따라 수명, 가격, 성능이 다르다. 
		- 썻다 지우기를 자주 반복해야 하는 경우 혹은 높은 성능을 원하는 경우에는 고가의 SLC 타입을 선택하는 것이 좋다. 
		- 저가의 대용량 저장 장치를 원한다면 TLC 타입을 선택하는 것이 좋다.
		- 그 중간을 원한다면 MLC 타입의 저장 장치를 선택하는 것이 좋다.

| 구분 | SLC | MLC | TLC |
| ---- | ---- | ---- | ---- |
| 셀당 bit | 1bit | 2bit | 3bit |
| 수명 | 길다 | 보통 | 짧다 |
| 읽기/쓰기 속도 | 빠르다 | 보통 | 느리다 |
| 용량 대비 가격 | 높다 | 보통  | 낮다 |

- 셀보다 더 큰 단위
	- 플래시 메모리 저장 단위 
		- 셀이 모여 만들어진 단위를 페이지(page)
		- 페이지가 모여 만들어진 단위를 블록(block)
		- 블록이 모여 플레인(plane)
		- 플레인이 모여 다이(die)가 된다.
		- 셀 > 페이지 > 블록 > 플레인 > 다이
		- 저장 단위 이미지
			![[Pasted image 20240110070019.png]]
	- 페이지
		- 페이지는 Free, Valid, Invalid 상태라는 세 개의 상태를 가질 수 있다.
		- Free 상태
			- 어떠한 데이터도 저장하고 있지 않아 새로운 데이터를 저장할 수 있는 상태를 의미 
		- Valid 상태 
			- 이미 유효한 데이터를 저장하고 있는 상태를 의미
		- Invalid 상태
			쓰레기값이라 부르는 유효하지 않은 데이터를 저장하고 있는 상태를 의미
			플래시 메모리는 하드 디스크와는 달리 덮어쓰기가 불가능하여 
			Valid 상태인 페이지에는 새 데이터를 저장할 수 없다.
	- 플래시 메모리의 간단한 동작을 예시
		1. X라는 블록이 네 개의 페이지로 이루어져 있다고 가정
		2. 그 중 두 개의 페이지에는 A와 B라는 데이터가 저장되어 있다고 가정
		3. 여기서 블록 X에 새로운 데이터 C를 저장한다면 어떻게 될것인가? 
		4. 플래시 메모리의 읽기 쓰기 단위는 페이지이므로 오른쪽 아래와 같이 저장된다. 
		5. 여기서 새롭게 저장된 C와 기존에 저장되어 있던 B는 그대로 둔 채 기존의 A만을 A-2로 수정하고 싶다면 어떻게 해야할까? 
		6. 플래시 메모리에서 덮어쓰기는 불가능하기 때문에 기존에 저장된 A는 
			Invalid 상태가 되어 더 이상 값이 유효하지 않은 쓰레기값이 되고, 
			새로운 A 데이터가 저장된다. 
		7. 결과적으로 블록 X의 Valid 페이지는 B, C, A-2가 된다.
		8. 그런데 여기서 문제가 있다. 
			A와 같이 쓰레기값을 저장하고 있는 공간은 사용하지 않을 공간인데도 불구하고 용량을 차지하고 있다. 
			이는 엄연히 용량 낭비이다. 그렇다고 A만 지울 수도 없다. 
			앞서 언급했듯이 플래시 메모리에서 삭제는 블록 단위로 수행되기 때문이다. 
			그래서 최근 SSD를 비롯한 플래시 메모리는 
			이런 쓰레기값을 정리하기 위해 가비지 컬렉션 기능을 제공한다.
----
### 퀴즈

디스커션 링크: